<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>üòà Troll Website Zuizui</title>

<style>
body{
  background:black;
  color:white;
  font-family:Arial;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  text-align:center;
  transition:background 0.1s;
  overflow:hidden;
}
.box{ animation:shake 0.3s infinite; max-width:340px; }
img{ width:200px; }
h1{ color:red; }

button{
  margin:10px;
  padding:10px 16px;
  font-size:16px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
.ok{ background:#00ff99; }
.no{ background:#ff6666; }

#eyeText{
  font-size:24px;
  color:red;
  opacity:0;
  position:relative;
  animation:glitch 0.2s infinite;
}

#lv2Box{
  display:none;
  flex-direction:column;
}

#finalScreen{
  display:none;
  position:absolute;
  top:0;left:0;
  width:100%;height:100%;
  background:black;
  color:red;
  font-size:50px;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

#finalScreen p{
  animation:glitchFinal 0.1s infinite;
}

#endScreen{
  display:none;
  position:absolute;
  top:0;left:0;
  width:100%;height:100%;
  background:black;
  color:white;
  font-size:60px;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

#warning{
  position:absolute;
  top:20px;
  width:100%;
  color:red;
  font-size:40px;
  display:none;
}

#version{
  position:absolute;
  bottom:10px;
  right:10px;
  color:yellow;
  font-size:14px;
  z-index:9999;
}

@keyframes glitch{
  0%{ text-shadow:2px 0 red,-2px 0 cyan; }
  25%{ text-shadow:-2px -2px red,2px 2px cyan; }
  50%{ text-shadow:2px 2px red,-2px -2px cyan; }
  75%{ text-shadow:-2px 0 red,2px 0 cyan; }
  100%{ text-shadow:0 0 red; }
}

@keyframes shake{
  0%{transform:translate(0,0);}
  25%{transform:translate(3px,-3px);}
  50%{transform:translate(-3px,3px);}
  75%{transform:translate(3px,3px);}
  100%{transform:translate(0,0);}
}

@keyframes glitchFinal{
  0%{transform:translate(0,0) rotate(0deg); color:red;}
  20%{transform:translate(-2px,2px) rotate(-2deg); color:#ff0000;}
  40%{transform:translate(2px,-2px) rotate(2deg); color:#ff5555;}
  60%{transform:translate(-2px,1px) rotate(-1deg); color:#ff2222;}
  80%{transform:translate(1px,-1px) rotate(1deg); color:red;}
  100%{transform:translate(0,0) rotate(0deg); color:red;}
}
</style>
</head>

<body>

<div class="box" id="mainBox">
  <img src="https://i.imgur.com/9Tq4F7Q.png">
  <h1>üòà C√¢u h·ªèi</h1>
  <p><b>B·∫°n c√≥ mu·ªën ƒë·ªÉ qu·∫£n tr·ªã vi√™n th·∫•y IP c·ªßa b·∫°n kh√¥ng?</b></p>

  <button class="ok" onclick="start(true)">ok tao kh√¥ng s·ª£ üòé</button>
  <button class="no" onclick="start(false)">th√¥i tao b·ªè cu·ªôc r·ªìi ü•Ä</button>

  <p id="status"></p>
  <p id="countdown"></p>
  <p id="eyeText">üëÅÔ∏è TAO TH·∫§Y M√ÄY R·ªíI</p>
</div>

<div id="lv2Box">
  <h1>üî• B·∫°n c√≥ mu·ªën l√™n lv 2 ch·ª©?</h1>
  <button onclick="lv2(true)">ƒë∆∞·ª£c chi·∫øn lu√¥n s·ª£ ƒë·∫øch g√¨</button>
  <button onclick="lv2(false)">th√¥i t√¥i b·ªè cu·ªôc r·ªìi</button>
</div>

<div id="finalScreen">
  <img src="https://i.imgur.com/9Tq4F7Q.png" style="width:300px;">
  <p>k·∫ª h√®n nh√°t</p>
</div>

<div id="endScreen">
  END
</div>

<div id="warning">
  ‚ö†Ô∏è C·∫¢NH B√ÅO ‚ö†Ô∏è
</div>

<div id="version">v0.1 alpha</div>

<audio id="laugh" src="laugh.mp3"></audio>
<audio id="whisper" src="whisper.mp3" loop></audio>
<audio id="scare" src="scare.mp3" loop></audio>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
emailjs.init("IN7hif-GDxhAv9Eyq");

let started=false, flashInt=null, pitch=1, lv2Flash=null, glitchInterval=null, faceInterval=null, lv2EndTimeout=null;

function start(sendIP){
  if(started) return;
  started=true;

  document.getElementById("status").innerText="üòà Qu√° mu·ªôn r·ªìi...";
  fakeCountdown();

  if(sendIP){
    fetch("https://api.ipify.org?format=json")
      .then(r=>r.json())
      .then(d=>{
        emailjs.send("service_bb9m4wq","template_myeqwig",{
          visitor_ip:d.ip,
          user_agent:navigator.userAgent,
          time:new Date().toLocaleString()
        });
      });
  }

  setTimeout(startTroll,5000);
  setTimeout(enableLv2,36000); // 36 gi√¢y
}

function startTroll(){
  laughLoop();
  whisperLoop();
  flash();
  vibrate();
  showEye();
  setTimeout(stopAll,15000);
}

function laughLoop(){
  const a=document.getElementById("laugh");
  let vol=0.2;
  function loop(){
    if(!started) return;
    pitch+=0.15;
    vol=Math.min(vol+0.1,1);
    a.playbackRate=pitch;
    a.volume=vol;
    a.currentTime=0;
    a.play();
    setTimeout(loop,1200);
  }
  loop();
}

function whisperLoop(){
  const w=document.getElementById("whisper");
  let vol=0.05;
  w.volume=vol;
  w.play();
  const inc=setInterval(()=>{
    if(!started){ clearInterval(inc); return; }
    vol=Math.min(vol+0.05,0.6);
    w.volume=vol;
  },1000);
}

function flash(){
  flashInt=setInterval(()=>{
    document.body.style.background=
      document.body.style.background==="red"?"black":"red";
  },120);
}

function vibrate(){
  if(navigator.vibrate){
    navigator.vibrate([300,100,300,100,500]);
  }
}

function showEye(){
  document.getElementById("eyeText").style.opacity=1;
}

function fakeCountdown(){
  let n=5;
  const el=document.getElementById("countdown");
  const t=setInterval(()=>{
    el.innerText="B·∫Øt ƒë·∫ßu sau "+n+"...";
    n--;
    if(n<0){ clearInterval(t); el.innerText=""; }
  },1000);
}

function stopAll(){
  started=false;
  clearInterval(flashInt);
  document.body.style.background="black";
  document.getElementById("laugh").pause();
  document.getElementById("whisper").pause();
}

// Ch·∫°m ‚Üí rung
document.body.addEventListener("click",()=>{
  if(started && navigator.vibrate) navigator.vibrate(200);
});

// 36s ‚Üí lv2
function enableLv2(){
  stopAll();
  document.getElementById("mainBox").style.display="none";
  document.body.style.background="#8B0000"; // m√°u
  document.getElementById("lv2Box").style.display="flex";

  // B·∫Øt ƒë·∫ßu 36s t√≠nh t·ª´ lv2 ‚Üí END
  lv2EndTimeout = setTimeout(lv2End,36000);
}

// LV2 h√†nh ƒë·ªông
function lv2(choice){
  document.getElementById("lv2Box").style.display="none";
  const final=document.getElementById("finalScreen");
  final.style.display="flex";

  const scareAudio=document.getElementById("scare");
  scareAudio.volume=0.2;
  scareAudio.play();

  // Nh√°y ƒë·ªè + rung
  lv2Flash=setInterval(()=>{
    document.body.style.background=
      document.body.style.background==="red"?"black":"red";
    if(navigator.vibrate) navigator.vibrate(150);
  },200);

  // Glitch ch·ªØ
  const text=document.querySelector("#finalScreen p");
  glitchInterval=setInterval(()=>{
    text.style.opacity = text.style.opacity === "1" ? "0" : "1";
  },200);

  // M·∫∑t c∆∞·ªùi glitch bay
  faceInterval=setInterval(()=>{
    const face=document.createElement("img");
    face.src="https://i.imgur.com/9Tq4F7Q.png";
    face.style.position="absolute";
    face.style.width="50px";
    face.style.left=Math.random()*window.innerWidth+"px";
    face.style.top=Math.random()*window.innerHeight+"px";
    face.style.zIndex=999;
    document.body.appendChild(face);
    setTimeout(()=>face.remove(),1000);
  },150);

  // N·∫øu b·ªè cu·ªôc ‚Üí fake kick
  if(!choice){
    document.body.style.pointerEvents="none";
    document.body.style.cursor="not-allowed";
    setTimeout(()=>{
      document.body.style.pointerEvents="auto";
      document.body.style.cursor="default";
    },5000);
  }
}

// K·∫øt th√∫c lv2 ‚Üí END + c·∫£nh b√°o 3s
function lv2End(){
  // D·ª´ng to√†n b·ªô hi·ªáu ·ª©ng
  clearInterval(lv2Flash);
  clearInterval(glitchInterval);
  clearInterval(faceInterval);
  document.getElementById("finalScreen").style.display="none";
  document.getElementById("warning").style.display="block";
  document.getElementById("endScreen").style.display="flex";

  // Flash & jumpscare trong 3s
  let flashCount=0;
  const warningFlash = setInterval(()=>{
    document.getElementById("warning").style.color =
      document.getElementById("warning").style.color==="red"?"white":"red";
    flashCount++;
    if(flashCount>15){ // 3s v·ªõi 200ms interval
      clearInterval(warningFlash);
      document.getElementById("warning").style.display="none";
    }
  },200);
}
</script>
</body>
</html>